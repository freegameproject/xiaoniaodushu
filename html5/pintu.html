<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=2.0,maximum-scale=1,user-scalable=no">
    <title></title>
    <style>
        .canvas {
            width: 300px;
            height: 300px;
            margin: auto;
            position: fixed;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background: #ccc;
        }

        .obj {
            position: absolute;
            top: 0;
            left: 0;
            width: 100px;
            height: 100px;
            text-align: center;
            line-height: 100px;
            transition: all 0.5s;
        }

        .obj[at=map_11] {
            top: 0px;
            left: 0px;
        }

        .obj[at=map_12] {
            top: 0px;
            left: 100px;
        }

        .obj[at=map_13] {
            top: 0px;
            left: 200px;
        }

        .obj[at=map_21] {
            top: 100px;
            left: 0px;
        }

        .obj[at=map_22] {
            top: 100px;
            left: 100px;
        }

        .obj[at=map_23] {
            top: 100px;
            left: 200px;
        }

        .obj[at=map_31] {
            top: 200px;
            left: 0px;
        }

        .obj[at=map_32] {
            top: 200px;
            left: 100px;
        }

        .obj[at=map_33] {
            top: 200px;
            left: 200px;
        }
    </style>
</head>
<body>

<div class="canvas">
    <div class="obj" id="obj_1" at="map_11"></div>
    <div class="obj" id="obj_2" at="map_12"></div>
    <div class="obj" id="obj_3" at="map_13"></div>
    <div class="obj" id="obj_4" at="map_21"></div>
    <div class="obj" id="obj_5" at="map_22"></div>
    <div class="obj" id="obj_6" at="map_23"></div>
    <div class="obj" id="obj_7" at="map_31"></div>
    <div class="obj" id="obj_8" at="map_32"></div>
    <div class="obj" id="obj_9" at="map_33"></div>
</div>

<script>
    var map = [];

    var obj_map = [1, 2, 3, 4, 5, 6, 7, 8, 0];
    var at_map = [11, 12, 13, 21, 22, 23, 31, 32, 33];

    function start() {

        var random_at_map = at_map.sort(function (x, y) {
            return Math.random() > 0.5 ? -1 : 1
        });

        var random_obj_map = obj_map.sort(function (x, y) {
            return Math.random() > 0.5 ? -1 : 1
        });



        map[11] = random_obj_map[0];
        map[12] = random_obj_map[1];
        map[13] = random_obj_map[2];

        map[21] = random_obj_map[3];
        map[22] = random_obj_map[4];
        map[23] = random_obj_map[5];

        map[31] = random_obj_map[6];
        map[32] = random_obj_map[7];
        map[33] = random_obj_map[8];





        if (random_obj_map[0] != 0) {
            document.querySelector('#obj_'+map[11]).innerText = random_obj_map[0];
            document.querySelector('#obj_'+map[11]).setAttribute('at','map_11');
        }
        if (random_obj_map[1] != 0) {
            document.querySelector('#obj_'+map[12]).innerText = random_obj_map[1];
            document.querySelector('#obj_'+map[12]).setAttribute('at','map_12');

        }
        if (random_obj_map[2] != 0) {
            document.querySelector('#obj_'+map[13]).innerText = random_obj_map[2];
            document.querySelector('#obj_'+map[13]).setAttribute('at','map_13');

        }
        if (random_obj_map[3] != 0) {
            document.querySelector('#obj_'+map[21]).innerText = random_obj_map[3];
            document.querySelector('#obj_'+map[21]).setAttribute('at','map_21');

        }
        if (random_obj_map[4] != 0) {
            document.querySelector('#obj_'+map[22]).innerText = random_obj_map[4];
            document.querySelector('#obj_'+map[22]).setAttribute('at','map_22');

        }
        if (random_obj_map[5] != 0) {
            document.querySelector('#obj_'+map[23]).innerText = random_obj_map[5];
            document.querySelector('#obj_'+map[23]).setAttribute('at','map_23');

        }
        if (random_obj_map[6] != 0) {
            document.querySelector('#obj_'+map[31]).innerText = random_obj_map[6];
            document.querySelector('#obj_'+map[31]).setAttribute('at','map_31');

        }
        if (random_obj_map[7] != 0) {
            document.querySelector('#obj_'+map[32]).innerText = random_obj_map[7];
            document.querySelector('#obj_'+map[32]).setAttribute('at','map_32');

        }
        if (random_obj_map[8] != 0) {
            document.querySelector('#obj_'+map[33]).innerText = random_obj_map[8];
            document.querySelector('#obj_'+map[33]).setAttribute('at','map_33');

        }


    }


    function left() {
        check();
    }
    function right() {
        check();
    }
    function up() {

        var from = 0;
        var to = 0;
        var obj = '';


        if (map[11] == 0) {
            from = 21;
            to = 11;
        }

        else if (map[12] == 0) {
            from = 22;
            to = 12;
        }

        else if (map[13] == 0) {
            from = 23;
            to = 13;
        }

        else if (map[21] == 0) {
            from = 31;
            to = 21;
        }

        else if (map[22] == 0) {
            from = 32;
            to = 22;
        }

        else if (map[23] == 0) {
            from = 33;
            to = 23;
        }

        move(from, to);


        check();
    }
    function down() {

        var from = 0;
        var to = 0;
        var obj = '';


        if (map[31] == 0) {
            from = 21;
            to = 31;
        }

        else if (map[32] == 0) {
            from = 22;
            to = 32;
        }

        else if (map[33] == 0) {
            from = 23;
            to = 33;
        }

        else if (map[21] == 0) {
            from = 11;
            to = 21;
        }

        else if (map[22] == 0) {
            from = 12;
            to = 22;
        }

        else if (map[23] == 0) {
            from = 13;
            to = 23;
        }

        move(from, to);

        check();
    }

    function left() {
        var from = 0;
        var to = 0;
        var obj = '';


        if (map[11] == 0) {
            from = 12;
            to = 11;
        }

        else if (map[12] == 0) {
            from = 13;
            to = 12;
        }

        else if (map[21] == 0) {
            from = 22;
            to = 21;
        }

        else if (map[22] == 0) {
            from = 23;
            to = 22;
        }

        else if (map[31] == 0) {
            from = 32;
            to = 31;
        }

        else if (map[32] == 0) {
            from = 33;
            to = 32;
        }

        move(from, to);
        check();
    }

    function right() {

        var from = 0;
        var to = 0;
        var obj = '';


        if (map[12] == 0) {
            from = 11;
            to = 12;
        }

        else if (map[13] == 0) {
            from = 12;
            to = 13;
        }

        else if (map[22] == 0) {
            from = 21;
            to = 22;
        }

        else if (map[23] == 0) {
            from = 22;
            to = 23;
        }

        else if (map[32] == 0) {
            from = 31;
            to = 32;
        }

        else if (map[33] == 0) {
            from = 32;
            to = 33;
        }

        move(from, to);
        check();
    }

    function move(from, to) {
        if (to != 0 && from!=0) {
            var obj=document.querySelector('.obj[at=map_' + from + ']');
            map[to] = parseInt(obj.getAttribute('id').replace('obj_', ''));
            obj.setAttribute('at', 'map_' + to);
            map[from] = 0;
        }
    }

    function check() {

        if (map[11] === 1 && map[12] === 2 && map[13] === 3 && map[21] === 4 && map[22] === 5 && map[23] === 6 && map[31] === 7 && map[32] === 8 && map[33] === 9) {
            success();
        } else {
            unsuccess();
        }
    }

    function success() {
        console.log('ok');
        alert('ok');

    }

    function unsuccess() {
        //console.log('no');
    }


    document.addEventListener('touchstart', function () {
        event.preventDefault();
        var touch = event.touches[0]; //获取第一个触点
        start_x = Number(touch.pageX); //页面触点X坐标
        start_y = Number(touch.pageY); //页面触点Y坐标
    });
    document.addEventListener('touchmove', function () {
        event.preventDefault();
        var touch = event.touches[0]; //获取第一个触点
        end_x = Number(touch.pageX); //页面触点X坐标
        end_y = Number(touch.pageY); //页面触点Y坐标
    });


    document.addEventListener('touchend', function () {
        event.preventDefault();

        var zy = start_x - end_x;//左右
        var sx = start_y - end_y;//上下

        if (Math.abs(zy) > Math.abs(sx)) {
            //zy
            if (zy > 0) {
                left();
            }
            if (zy < 0) {
                right();
            }

        }

        if (Math.abs(zy) < Math.abs(sx)) {
            //sx
            if (sx > 0) {
                up();
            }
            if (sx < 0) {
                down();
            }
        }


    });


    start();


</script>
</body>
</html>